(lambda entry:(lambda sude,nkin:(lambda sex,regex:(lambda ruined,gaydar:(lambda bent:(lambda cc:(lambda hind,fore:nkin("unmatched ']'")if-1 in(hind)else(lambda clitoris:(lambda backroom,orifice,kleene:(lambda V,P,sh:(lambda bra:nkin("unmatched ')'")if-1==bra else(lambda kleened:nkin("nothing to repeat")if-1==kleened else(lambda SeanArcher:nkin("nothing to repeat")if-1 in(SeanArcher)else"expression cannot match anything"if not(SeanArcher)else sorted(SeanArcher[::-1],key=len)[0])([e for(e)in[V(P,V,s)for(s)in orifice(kleened)]if e!=None]))(kleene(bra)))(backroom(sh)))(lambda P,V,lost:(lambda professed:-1 if any(map(lambda E:type(E)==nkin,professed))else(None)if(None)in(professed)else''.join(professed))([P(V,P,e)if list==type(e)else(e)for(e)in lost]),lambda V,P,sh:(lambda bra:nkin("unmatched ')'")if-1==bra else(lambda kleened:nkin("nothing to repeat")if-1==kleened else(lambda CastorTroy:nkin("nothing to repeat")if-1 in(CastorTroy)else(None)if not(CastorTroy)else sorted(CastorTroy[::-1],key=len)[0])([e for(e)in[V(P,V,s)for(s)in orifice(kleened)]if e!=None]))(kleene(bra)))(backroom(sh)),[c for(s,e)in list(clitoris)for(c)in ruined[e+1:s]+[None]][:-1]))(lambda sh:(lambda parent:(lambda penis,heart:-1 if-1 in(penis)else(lambda
olus2000, WINS_code_guessing:[c for i,(s,e)in sude(WINS_code_guessing)for(c)in sh[olus2000[i][1]+1:olus2000[i][0]]+[sh[s+1:e]]]+sh[olus2000[-1][1]+1:olus2000[-1][0]])((list(zip(heart+[len(sh)],[-1]+penis))),(zip(heart,penis))))(parent[0],parent[1]))(bent(sh,'(',')')),lambda sh:(lambda organ:[sh[e+1:s]for(s,e)in zip(organ+[len(sh)],[-1]+organ)])(gaydar(sh,1)),lambda sh:(lambda gspot:-1 if-1 in(gspot)else[c for i,c in sude(sh)if not i in gspot and not i+1 in gspot])([-1 if sh[e-1]in[1,7]or not(e)else(e)for(e)in(gaydar(sh,7))])))(zip(fore+[len(ruined)],[-1]+hind)))(cc[0],cc[1]))(bent(ruined,'[',']')))(lambda sh,n,f:(lambda fore,hind:([c for(c)in[(lambda no:-1 if(no<i)else(None)if(no>i)else D)(len([x for(x)in(fore)if x<D])-1)for(i,D)in sude(hind)]if c!=None],[D for(i,D)in sude(fore)if len([x for(x)in(hind)if x<D])==i]))(gaydar(sh,regex([n])[0]),gaydar(sh,regex([f])[0]))))([c for(i,s)in sude([entry[sex[i-1]+2:D]for(i,D)in sude(sex)])for(c)in regex(s)+[entry[sex[i]+1]]][:-1],lambda s,t:[i for(i,c)in sude(s)if c==t]))([i for(i,c)in sude(entry)if c=='\\'and(lambda s:len(s.split([c for(c)in s[::-1].split(s[-1])if c][0][0])[-1])%2)(entry[:i+1])]+[-2],lambda s:[{'(':0,')':5,'[':3,']':2,'|':1,'*':7}.get(c,c)for(c)in s]))(enumerate,SyntaxError))(input()+'69')
